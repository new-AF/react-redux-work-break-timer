<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>
		
	</title>
	<script src="./libraries/babel.min.js"></script>
	<script src="./libraries/react.development.js"></script>
	<script src="./libraries/react-dom.development.js"></script>
	
	<!-- redux https://unpkg.com/redux@4.2.0/dist/redux.js -->
	<script src="./libraries/redux.js"></script>
	
	<!-- react-redux https://cdnjs.cloudflare.com/ajax/libs/react-redux/8.0.5/react-redux.js -->
	<script src="./libraries/react-redux.js"></script>
	
	<!-- font awesome icons -->
	<link href='./libraries/css/all.css' rel='stylesheet'>
	
	<style>
		body{
			margin: 0;
		}
		*{
			outline:1px solid black;
			font-family: "Consolas","Lucida Console", monospace, "Tahoma", sans-serif;
			color: black
		}
	</style>
</head>
  
<body>
	<main>
		<div id="react-container-1" class="react-container">
		
		<div>
	</main>
	
	<script type="text/babel">

		
		//----------------------- state0 Slider reducer ----------------------//
		const slider1State0={
			value:''
		};
		const slider2State0={
			value:''
		};

		//----------------------- Slider reducer ----------------------//
		const slider1Reducer=(state={...slider1State0}, action)=>{
			const newState={...state};
			const {value,type}=action;
			if(type==='range1-onchange'){
				newState['value']=value;
			}
			return newState;
		}
		const slider2Reducer=(state={...slider2State0}, action)=>{
			const newState={...state};
			const {value,type}=action;
			if(type==='range2-onchange'){
				newState['value']=value;
			}
			return newState;
		}
		
		//----------------------- map state to props ----------------------//
		const mapStateToProps= state=>state;

		//----------------------- map dispatch to props ----------------------//
		const mapDispatchToProps= dispatchFunction=>({
			'do-range1-onchange':event=>dispatchFunction({type:'range1-onchange',value:event.target.value}),
			'do-range2-onchange':event=>dispatchFunction({type:'range2-onchange',value:event.target.value}),
			/*---*/			
			'do-range1-minus':event=>dispatchFunction({type:'range1-minus',value:event.target.value}),
			'do-range1-plus':event=>dispatchFunction({type:'range1-plus',value:event.target.value}),
			/**/
			'do-range2-minus':event=>dispatchFunction({type:'range2-minus',value:event.target.value}),
			'do-range2-plus':event=>dispatchFunction({type:'range2-plus',value:event.target.value}),

		});
		//----------------------- react component Provider ----------------------//
		const Provider = ReactRedux.Provider;
		//----------------------- connect function ----------------------//
		const connect= ReactRedux.connect;
		//----------------------- store i.e. STATE object ----------------------//
		const store= Redux.createStore(Redux.combineReducers({
			slider1:		slider1Reducer,
			slider2:		slider2Reducer
		}));
		//----------------------- component Button ----------------------//
		const Button=props=>{
			const {text,onClick,onMouseDown,sentStyle,id}=props;
			const style={
				padding:'0 0.8rem',
				'font-size':'2rem',
				'cursor':'pointer',
				...sentStyle
			};
			return <button id={id} style={style} onClick={onClick} onMouseDown={onMouseDown}>
				{text}
			</button>;
		};
		//----------------------- component Slider ----------------------//
		const Slider=props=>{
	
			const {min,max,value:value0,onChange,defaultValue,plusId,minusId,valueId}=props;
			
			/*values0 is from state; and on first run it is '';*/
			const value= value0==='' ? defaultValue : value0;
			const text= value<60 ? `${value} minute(s)` : `${Math.floor(value/60)} hour(s), ${value%60} minutes`;
			
			const style={
				'display':'grid',
				border:'0.2rem solid black',
				'border-radius':'0.25rem'
			};
			/* FOR Testing purposes; value must an element by itself */
			const valueStyle={
				'color':'transparent',
				'grid-column':'1/4',
				'grid-row':'1',
				'text-align':'center'
			};

			const afterValueStyle={
				'grid-column':'1/4',
				'grid-row':'1',
				'text-align':'center'
			};
	
			const rangeStyle={
				'cursor':'pointer'
			};
			const buttonStyle={
				
			};
			
			/*simulate triggering event*/
			const b1= e=>onChange({target:{value: value>min && value<=max ? value-1 : value }});
			const b2= e=>onChange({target:{value: value>=min && value<max ? value+1 : value }});
			
			return <div style={style}>
				<div id={valueId} style={valueStyle}>{value}</div>
				<div style={afterValueStyle}>{text}</div>

				<Button id={plusId} sentStyle={buttonStyle} text={'-'} onClick={b1}/>
				<input style={rangeStyle} type='range' min={min} max={max} onInput={onChange} value={value}/>
				<Button id={minusId} sentStyle={buttonStyle} text={'+'} onClick={b2}/>
			</div>;
		};

		//----------------------- component SessionLength ----------------------//
		const SessionLength=props=>{
			const {text,slider,innerId,plusId,minusId,timeValueId}=props;
			const {min,max,value,defaultValue,onChange}=slider;
			const style={
			
			};
			const textStyle={
				'text-align':'center',
				'font-weight':'bold',
				'font-size':'1.5rem',
				'margin-bottom':'1rem'
			};

			return <div style={style}>
				<div style={textStyle} id={innerId}>{text}</div>
				<Slider min={min} max={max} onChange={onChange} value={value} defaultValue={defaultValue} plusId={plusId} minusId={minusId} valueId={timeValueId}/>
			</div>;
		};
		//----------------------- component Timer ----------------------//
		const Timer=props=>{
			const {text,sentStyle}=props;
			const style={
				...sentStyle
			};
			return <div style={style}>
				<div>Timer</div>
			</div>;
		};

		//----------------------- component App WITHOUT LOCAL STATE ----------------------//
		class App extends React.Component{
			constructor(props){
				super(props);
		
			}

			render(){
				const style= {
					'display':'grid',
					'grid-template-columns':'0.5fr 0.5fr',
					'grid-template-rows':'0.5fr 1fr 1fr 0.5fr',
					/**/
					'align-items':'center',
					'justify-items':'center',
					/**/
					'background-color': 'wheat',
					'min-height': '100vh',
				};
				const headerFooterStyle={
					'font-weight':'bold',
					'grid-column':'1/3'
				};
				const timerStyle={
					'grid-column':'1/3',
					'grid-row':'3'
				};
				const props=this.props;
				
				const {slider1,slider2}=props;
				
				/* break state */
				const slider1Things={
					value:			slider1.value,
					min:			1,
					max:			720,/*10hours*/
					defaultValue:	5,
					onChange:		props['do-range1-onchange']
				};
				
				/* work state */
				const slider2Things={
					value:			slider2.value,
					min:			1,
					max:			90,
					defaultValue:	25,
					onChange:		props['do-range2-onchange']
				};
				
				return (
				<div style={style}>
					
					<h1 style={headerFooterStyle}>React Redux Work/Break Timer</h1>
					
					<SessionLength plusId="break-increment" minusId="session-increment" innerId="break-label" text="Break Length" slider={slider1Things} timeValueId="break-length"/>
					
					<SessionLength plusId="break-decrement" minusId="session-decrement" innerId="session-label" text="Session Length" slider={slider2Things} timeValueId="session-length"/>
					
					<Timer sentStyle={timerStyle}/>
					
					<footer style={headerFooterStyle}><p>by Abdullah Fatota</p></footer>
				</div>);
			}
		}
		//----------------------- APP2 component ----------------------//
		const App2= connect(mapStateToProps, mapDispatchToProps)(App);
		
		//----------------------- react componentAppWrapper ----------------------//
		class AppWrapper extends React.Component{
			constructor(props){
				super(props);		
			}
			render(){
				//store prop IS REQUIRED.
				return (<Provider store={store}>
					<App2/>
				</Provider>);
			}
		}
		//----------------------- put component AppWrapper in DOM ----------------------//

		const container=document.querySelector('#react-container-1');
		ReactDOM.render(<AppWrapper/>,container);
		

	</script>

	<!-- free code camp test suite -->
	<script src="./libraries/test bundle.js"></script>

	
</body>

</html>